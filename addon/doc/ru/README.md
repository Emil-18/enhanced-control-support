# Расширенная поддержка элементов управления.
* Автор: Emil-18.
* Совместимость с NVDA: 2023.1 и более поздние версии.
* Скачать: [Стабильная версия](https://github.com/Emil-18/enhanced-control-support/releases/download/v1.1/enhancedControlSupport-1.1.nvda-addon).

Это дополнение позволяет использовать некоторые элементы управления, которые обычно не работают с NVDA.

Примечание:

Когда в этом дополнении говорится об элементах управления, речь не идёт об отдельных объектах. Например, вы не можете превратить только элементы списка в кнопки, весь список будет рассматриваться как одна кнопка.

То, что определяется как элемент управления, зависит от конкретного приложения. Например, кнопки диалога запуска определяются как один элемент управления. В отличие от этого, в калькуляторе windows 10 всё является частью одного элемента управления - самого окна.

На данный момент дополнение поддерживает:

* Кнопки.
* Флажки.
* Поля редактирования.
* Радиокнопки.
* Слайдеры.
* Текстовые элементы управления.

## Автоматическое распознавание типа элемента управления.

Когда NVDA встречает неизвестный элемент управления, он автоматически пытается определить его тип. Если он будет найден, то сообщение о нём будет максимально приближено к тому, что NVDA обычно сообщает при взаимодействии с этим типом элемента управления.

## Ручное изменение типа элемента управления.

Иногда, когда NVDA сообщает об элементе управления не как о неизвестном, а как о областии, невозможно определить, является ли элемент управления областью на самом деле или нет. В связи с этим в дополнении реализована функциональность, позволяющая заставить NVDA интерпретировать элемент управления как другой тип.

Вы также можете заставить NVDA использовать MSAA или UIA для доступа к элементу управления. Это полезно, если NVDA плохо ведёт себя с API доступа, который она выбирает самостоятельно.

Обычно NVDA использует либо MSAA, либо UIA для доступа к элементам управления, поэтому одно из этих значений будет идентично нормальному поведению NVDA.

Попробуйте изменить API доступа, если:

* Навигация по объектам в NVDA работает не так, как должна.
* NVDA не отслеживает фокус, но элемент управления частично или полностью работает с объектной навигацией и/или отслеживанием мыши.
* NVDA сообщает неверную информацию об элементе управления.

Вы можете сделать обе эти вещи с помощью комбинированного списка "тип элемента управления" (см. ниже).

## Работа с неизвестными элементами управления.

Если NVDA не может определить, что представляет собой элемент управления, тип элемента управления будет сообщён как «неизвестно», и NVDA попытается определить, где находится фокус, глядя на цвета текста. Обратите внимание, что элемент управления должен поддерживать просмотр экрана, чтобы это работало.

NVDA будет рассматривать текст, который имеет наименее повторяющийся цвет в элементе управления, как его имя, и при изменении имени будет обновляться как речь, так и шрифт Брайля, так что вы сможете выполнять такие действия, как перемещение по списку с помощью клавиш-стрелок.

Этого поведения также можно добиться в любом элементе управления, выбрав «неизвестно» в комбинированном списке "тип элемента управления (см. ниже).

Примечание:

Когда это дополнение включено, вы не сможете прочитать весь визуальный текст в элементе управления в режиме обзора объекта при посадке в неизвестный элемент управления, как это происходит обычно.

Чтобы восстановить нормальное поведение NVDA для текущего элемента управления, выберите «Использовать нормальное поведение NVDA» в комбинированном окне типа элемента управления (см. ниже).

## Улучшенный UIA.

При выборе этого параметра в комбинированном окне типа элемента управления (см. ниже), если вы находитесь в текстовом поле, NVDA будет отображать выбранные предложения так, как будто они имеют фокус.
Обратите внимание, что это может переписать пользовательскую поддержку NVDA для некоторых элементов управления.

## Улучшенная поддержка ввода текста.

В некоторых элементах управления NVDA ведет себя странно при наборе или удалении текста, например, не произносит удаленный символ/слово или не обновляет шрифт Брайля. В качестве примера можно привести основной элемент управления редактированием в visual studio. Расширенная поддержка набора текста призвана решить эти проблемы.
В некоторых элементах управления поддержка расширенного набора текста будет включена автоматически, но вы всегда можете включить ее, установив флажок «Использовать расширенную поддержку набора текста» в диалоге выбора типа элемента управления (см. ниже).

## Жесты:

* NVDA+ALT+C: открытие диалога, используемого для изменения типа управления для сфокусированного элемента управления.
* NVDA+ALT+SHIFT+C: открытие диалога, используемого для изменения типа управления для элемента управления, в котором находится объект навигатора.
* NVDA+alt+r: Сообщает тип элемента управления, в котором находится фокус, если он нажат один раз, или объект навигатора, если он нажат дважды.
## настройки диалога выбора типа элемента управления.

* Комбобокс типа элемента управления:
Это комбинированное окно, в котором перечислены все типы элементов управления, которые вы можете выбрать.
То, что вы выберете здесь, повлияет только на элементы управления в приложении, с которым вы взаимодействовали при открытии диалога.
Он также повлияет только на те элементы управления, которые аналогичны элементам управления, с которыми вы взаимодействовали до открытия диалога.
Допустим, вы изменили кнопку OK в диалоговом окне запуска, чтобы она воспринималась как флажок.
Теперь кнопки отмены и просмотра также будут отображаться как флажки, но поле редактирования по-прежнему будет отображаться как поле редактирования, поскольку это элемент управления другого типа.
То же самое, если вы, например, откроете диалог сохранения в word pad. Кнопки в нем все равно будут рассматриваться как кнопки, потому что они находятся в другой программе, а не в диалоге выполнения.
Обратите внимание, что при выборе «Использовать обычное поведение дополнения» все изменения, которые вы внесли в элемент управления с помощью этого дополнения, будут удалены.
Этого не происходит, когда вы выбираете «Использовать обычное поведение NVDA». Например, можно сделать так, чтобы элемент управления использовал обычное поведение NVDA и при этом не полагался на события.
Флажок * полагаться на события:
Это флажок, который позволяет выбрать, должна ли NVDA при взаимодействии с элементом управления полагаться на события - уведомления, отправляемые элементами управления программам чтения с экрана для оповещения их о таких вещах, как изменение имени. Большинство пользовательских элементов управления не реализуют события правильно, поэтому по умолчанию этот флажок выключен.
Он также будет считаться выключенным, когда NVDA автоматически распознает пользовательский элемент управления.
* Флажок Использовать расширенную поддержку набора текста
Это флажок, который позволяет выбрать, должна ли NVDA использовать расширенную поддержку набора текста при взаимодействии с элементом управления.
Это полезно, если NVDA странно ведет себя при наборе или удалении текста.
* Флажок Временно использовать обычное поведение дополнения для всех элементов управления:
если флажок установлен, NVDA будет использовать обычное поведение дополнений для всех элементов управления до тех пор, пока NVDA не будет перезапущена или флажок не будет снова снят. Это полезно, если вы изменили элемент управления, но при этом сломали NVDA до такой степени, что изменить элемент управления обратно уже невозможно.

## Журнал изменений
### версия 1.1

* Добавлена новая опция «расширенный UIA»
* Добавлена новая настройка «Усиленная поддержка печатных символов». Ее можно включить в любом элементе управления через диалог выбора типа элемента управления, но по умолчанию она будет включена для некоторых элементов управления
* Исправлены некоторые ошибки UIAutomation, присутствующие в NVDA.
### версия 1.0.1

Дополнение больше не должно воспроизводить звуки ошибок при изменении API доступности
### версия 1.0
Первоначальный выпуск.